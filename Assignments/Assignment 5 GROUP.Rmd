---
title: "Assignment 5"
author: "Eva Wilson"
date: "3/8/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# attach packages 
library(here)
library(purrr)
library(tidyverse)
library(testthat)
```

## Assignment Instructions 

Design a function - you can pick any subject and you can even make up the equations as long as they conceptually make sense
  X Make sure it has at least 2 inputs and 1 parameter (ideally more) and at least 2 outputs
  X Code your function in R, save as a R file in subdirectory called R
  X Make sure you include documentation (both at the top as we’ve shown in past examples, and inline)
  X Include some error checking

In an Rmarkdown file, generate some data for 2 of the function inputs
  Use a for loop to run the function for the data
  Repeat the “looping” using something from the “purrr” package
  Graph results (you can decide what the most interesting way to graph - you just need to make one graph)

X Write at least 2 tests for your function; store in a separate test file

Put this in a git repo that includes an R subdirectory a tests subsdirectory and an Rmarkdown file and submit the link on Gauchospace (or you can put all of this in a new git repo or a subdirectory of an existing git repo)

## Step 1. Source function 
```{r}
here("irrigation.R")
```

## Step 2. List assumptions 

1. **Precipitation:** The distribution of precipitation data can vary depending on the location and the time period being analyzed. However, in general, precipitation data is often positively skewed and can exhibit a long tail to the right, which means that the data can have extreme values or outliers.

Given the positively skewed nature of precipitation data, we use a logarithmic transformation to reduce the impact of extreme values and make the distribution more symmetrical. We assume that the mean precipitation is 10 mm/day with a standard deviation of 2 mm/day. 10 mm is approximately equal to 0.3937 inches. 

2. **ET:** We assume that average ET is consistent across all grass types is 2.04.

3. **Possible Crops:** There are 50 fields in our analysis. We assume each occurs equally (we use random sample).

## Step 3. Create data frames to test functionality
```{r}
# create vector of crop type
possible.crop = c("wheat","corn","barley")
# use sample to simulate a random recording of fields for analysis
possible.crop = base::sample(possible.crop, size=50, replace=T)
# possible.crop as a factor for better plotting
possible.crop = as.factor(possible.crop)
# to quickly get frequencies of different crops and to plot 
summary(possible.crop)
plot(possible.crop, col="blue")

# specify base ET (mm/day) (see assumptions)
# WE MAY WANT TO CONSIDER JUST INCREASING THIS VALUE SO THAT IT MAKES SENSE WITH OUR BIN VALUES SPECIFIED IN OUR FUNCTION 
base_ET = 2.04

# generate a log-normal distribution of random precipitation data
# note that 10 mm converts to 0.394 inches.  
precipitation <- rlnorm(100, meanlog = 10, sdlog = 2)
# view the first 10 values of the precipitation data
head(precipitation, 10)
# quickly visualize to see distribution
plot(density(precipitation))

# NOW I THINK WE NEED TO COMBINE THESE THREE VARIABLES INTO A SINGLE DATA FRAME WHERE WE HAVE: 
#1.CROP_TYPE
#2. ET VALUE (CONSISTENTLY 2.04)
#3. OUR RANGE OF PRECIP (LOG DISTRIBUTION)
#4. TIME OUTPUT (0-5) (REQUIRES LOOP)
#5. AMOUNT OUTPUT (1, 3, 5) (REQUIRES LOOP)
```

# use a *for* loop to run the function for the data 
```{r}
# HERE WE NEED TO GO THROUGH OUR CROP TYPE, ET AND PRECIP VALUES TO GENERATE TWO OUTPUTS: TIME AND AMOUNT. I ALMOST WONDER IF IT MAKES SENSE TO CHANGE THE "TIME" COMPONENT TO JUST A 

# BINARY - TO IRRIGATE YES OR NO DEPENDING ON ET - PE VALUES? 
# AND THEN DEPENDING ON THE ANSWER, WE APPLY CASE_WHEN TO THE SPECIFIC CROP 

# THIS MIGHT HELP US TO GRAPH?? SEE MY BRAINSTORM IMAGE BELOW

knitr::include_graphics(here("brainstorm_irrigation.png"))
```

# graph results
```{r}
# NOT SURE HOW TO CAPTURE TIME COMPONENT IN A GRAPH???? 
ggplot(data = , aes(x=, y=)+
        geom_histogram(stat="count")+
         labs()
```

# run two tests to make sure this function is working
```{r}
# source data
here("irrigation.R")
# put your test in a file
# LET ME KNOW IF YOU HAVE PROBLEMS ACCESSING THIS? I JUST CREATED TWO BASIC FUNCTION TESTS USING EXPECT_EQUAL
test_file("/Users/evawilson/Desktop/ESM262_Eva/tests/irrigation_works.R")
```
